use agentKnowledge as knowledge.

module tygronEvents {
	%%%%% Percept Processing %%%%%
	if percept(stakeholders(X)), bel(stakeholders(Y)) 
		then delete(stakeholders(Y)) + insert(stakeholders(X)).
	if percept(settings(X)), bel(settings(Y)) 
		then delete(settings(Y)) + insert(settings(X)).
	if percept(functions(X)), bel(functions(Y)) 
		then delete(functions(Y)) + insert(functions(X)).
	if percept(buildings(X)), bel(buildings([])) 
		then delete(buildings([])) + insert(buildings(X)).
	if percept(indicators(X)), bel(indicators(Y)) 
		then delete(indicators(Y)) + insert(indicators(X)).
	if percept(lands(X)), bel(lands(Y)) 
		then delete(lands(Y)) + insert(lands(X)).
	if percept(zones(X)), bel(zones(Y)) 
		then delete(zones(Y)) + insert(zones(X)).
	if percept(requests(X)), bel(requests(Y)) 
		then delete(requests(Y)) + insert(requests(X)).
	if percept(actions(X)), bel(actions(Y)) 
		then delete(actions(Y)) + insert(actions(X)).
	if percept(upgradeTypes(X)), bel(upgradeTypes(Y)) 
		then delete(upgradeTypes(Y)) + insert(upgradeTypes(X)).
		
	%Add the goal of answering a request every time the agent receives one
	if bel(requests(X), not(empty(X)), member(request(Type, Category, PopupID, ContentlinkID, VisibleStakeholderIDs, ActionLogIDS, Price, Multipolygon, AreaSize, Answers), X))
		then adopt(answerRequest(Category, PopupID)).

	%Custom actions percepts
	%If we have no believe about this CallID insert it
	if percept(relevant_areas(CallID,MPList)), not(bel(relevant_areas(CallID, _)))
		then insert(relevant_areas(CallID,MPList)).
	%If we have a believe about this CallID update it
	if percept(relevant_areas(CallID,MPList)), bel(relevant_areas(CallID, OldMPList))
		then delete(relevant_areas(CallID, OldMPList))+ insert(relevant_areas(CallID,MPList)).
	
	%Remove areas from the list that are smaller then 200
	if bel(relevant_areas(CallID, OldMPList), getLargeAreas(OldMPList, NewMPList))
		then delete(relevant_areas(CallID, OldMPList)) + insert(relevant_areas(CallID, NewMPList)).

	%update indicator when it does exist but is changed.
	forall percept(indicators(X)), bel(indicatorlink(Weights), member(indicatorWeights(IndicatorID, Name, _), Weights), indicators(Indicators), member(indicator(IndicatorID, Current, Target, _), Indicators)), bel(indicator(IndicatorID, Name, OldCurrent, Target))
		do delete(indicator(IndicatorID, Name, OldCurrent, Target)) + insert(indicator(IndicatorID, Name, Current, Target)).
	
	%set up the goals for the indicators
	forall bel(indicator(_, Name, _, Target)), goal(getIndicatorGoals)
		do adopt(indicatorGoal(Name, Target)).
	
	%we can drop this after the first run%
	%we can't seem to fix this by placing it in the init module""
	if goal(getIndicatorGoals)
		then drop(getIndicatorGoals).
}
