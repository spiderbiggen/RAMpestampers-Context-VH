use agentKnowledge as knowledge.
use tygron as actionspec.

order=linearall.

module sellLandHandler {
	
	%If we believe a piece of land has been sold we should delete the believe.
	forall bel(landToSell(MultiPolygon, Price, StakeholderList), sold(MultiPolygon))
		do delete(landToSell(MultiPolygon, Price, StakeholderList)).
	
	%forall sellLand that we have already proposed to every stakeholder, lower the price and start over
	forall bel(landToSell(MultiPolygon, Price, Stakeholders), length(Stakeholders)=5, adjustSellPrice(Price, NewPrice))
		do delete(landToSell(MultiPolygon, Price, Stakeholders)) + insert(landToSell(MultiPolygon, NewPrice, [0, 3])).
	
	%forall the land we have to sell, make a proposal to a stakeholder that we havn't proposed it yet
	%update the landToSell believe with the new Stakeholder
	if bel(allStakeholders(AllStakeholders), (member(StakeholderID, AllStakeholders)), landToSell(MultiPolygon, Price, Stakeholders)), not(bel(member(StakeholderID, Stakeholders)))
		then map_sell_land(StakeholderID, MultiPolygon, Price) + delete(landToSell(MultiPolygon, Price, Stakeholders)) + insert(landToSell(MultiPolygon, Price, [StakeholderID|Stakeholders])).
}